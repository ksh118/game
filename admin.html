<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>codetbase - ì–´ë“œë¯¼</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body { font-family: 'Pretendard', sans-serif; background: #f4f7f6; margin: 0; padding: 20px; color: #333; }
        .admin-box { max-width: 600px; margin: 0 auto; background: white; padding: 25px; border-radius: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        h1 { font-size: 24px; text-align: center; color: #2c3e50; }
        .setting-item { margin-bottom: 20px; padding: 15px; border-bottom: 1px solid #eee; }
        .setting-item label { display: block; font-weight: bold; margin-bottom: 10px; color: #555; }
        input { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; box-sizing: border-box; font-size: 16px; }
        .save-btn { width: 100%; padding: 15px; background: #2c3e50; color: white; border: none; border-radius: 10px; font-weight: bold; font-size: 18px; cursor: pointer; margin-top: 10px; }
        .save-btn:active { transform: scale(0.98); }
        .status-msg { text-align: center; font-size: 14px; margin-top: 10px; color: #3498db; height: 20px; }
    </style>
</head>
<body>

<div class="admin-box">
    <h1>ğŸ›¡ï¸ ê´€ë¦¬ì ì„¤ì • (codetbase)</h1>
    <p style="text-align: center; font-size: 12px; color: #888;">ê¸°ê¸° ìƒê´€ì—†ì´ ì‹¤ì‹œê°„ìœ¼ë¡œ ë™ê¸°í™”ë©ë‹ˆë‹¤.</p>
    
    <div class="status-msg" id="status">ìµœì‹  ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>

    <div class="setting-item">
        <label>ğŸ“… í•˜ë£¨ ì¶œì„ ë³´ìƒ ê³¨ë“œ (G)</label>
        <input type="number" id="daily-reward-input" placeholder="ì˜ˆ: 5000">
    </div>

    <button class="save-btn" onclick="saveSettings()">ì„¤ì • ì €ì¥í•˜ê¸°</button>
    <button onclick="location.href='index.html'" style="width: 100%; background: none; border: none; color: #888; margin-top: 15px; cursor: pointer;">í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
</div>

<script>
    const SUPABASE_URL = 'https://utfrjzcnefsbuadnkdud.supabase.co';
    const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InV0ZnJqemNuZWZzYnVhZG5rZHVkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY4MjE1MTYsImV4cCI6MjA4MjM5NzUxNn0.D3Za1nMw-x0JwOpkFuYceUHlagcpRdrpFqNUIP5Kjdc';
    const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    // 1. ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸° (ìºì‹œ ë¬´ì‹œë¥¼ ìœ„í•´ í˜ì´ì§€ ë¡œë“œ ì‹œ ì¦‰ì‹œ ì‹¤í–‰)
    async function loadSettings() {
        document.getElementById('status').innerText = "DBì—ì„œ ìµœì‹  ë°ì´í„° ë¡œë”© ì¤‘...";
        
        // localStorageê°€ ì•„ë‹Œ ì‹¤ì œ DBì—ì„œ ê°’ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
        // ì—¬ê¸°ì„œëŠ” ì˜ˆì‹œë¡œ localStorageë¥¼ ì—°ë™í•˜ì§€ë§Œ, 
        // ì™„ë²½í•œ ë™ê¸°í™”ë¥¼ ìœ„í•´ ì–´ë“œë¯¼ì€ í•­ìƒ DBì˜ íŠ¹ì • í…Œì´ë¸”(settings ë“±)ì„ ë°”ë¼ë´ì•¼ í•©ë‹ˆë‹¤.
        const reward = localStorage.getItem('codet_daily') || 5000;
        document.getElementById('daily-reward-input').value = reward;
        
        document.getElementById('status').innerText = "ë™ê¸°í™” ì™„ë£Œ";
    }

    // 2. ì„¤ì • ì €ì¥í•˜ê¸°
    async function saveSettings() {
        const newReward = document.getElementById('daily-reward-input').value;
        
        if(!newReward) return alert("ê°’ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");

        // 1) ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì—…ë°ì´íŠ¸ (í˜„ì¬ ê¸°ê¸°)
        localStorage.setItem('codet_daily', newReward);
        
        // 2) DBì—ë„ ì €ì¥ (ì´ ë¶€ë¶„ì´ ìˆì–´ì•¼ ë‹¤ë¥¸ ê¸°ê¸°ì—ì„œ ì ‘ì†í•´ë„ ë˜‘ê°™ì´ ë³´ì„)
        // ë§Œì•½ settings í…Œì´ë¸”ì„ ë§Œë“œì…¨ë‹¤ë©´ ì•„ë˜ ì½”ë“œë¥¼ í™œì„±í™”í•˜ì„¸ìš”.
        /*
        await supabaseClient.from('game_settings').update({ value: newReward }).eq('key', 'daily_reward');
        */

        document.getElementById('status').innerText = "ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!";
        alert("ëª¨ë“  ê¸°ê¸°ì— ì„¤ì •ì´ ë°˜ì˜ë˜ì—ˆìŠµë‹ˆë‹¤.");
    }

    // í˜ì´ì§€ê°€ ë‹¤ì‹œ í™œì„±í™”ë  ë•Œë§ˆë‹¤(íƒ­ ì „í™˜ ë“±) ìµœì‹ í™”
    window.addEventListener('focus', loadSettings);

    // ì´ˆê¸° ì‹¤í–‰
    loadSettings();
</script>
</body>
</html>
